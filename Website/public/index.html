<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Chair checkup graph</title>

	<style media="screen">
		body { background: #ECEFF1; color: rgba(0,0,0,0.87); font-family: Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
		#message { background: white; max-width: 360px; margin: 100px auto 16px; padding: 32px 24px; border-radius: 3px; }
		#message h2 { color: #ffa100; font-weight: bold; font-size: 16px; margin: 0 0 8px; }
		#message h1 { font-size: 22px; font-weight: 300; color: rgba(0,0,0,0.6); margin: 0 0 16px;}
		#message p { line-height: 140%; margin: 16px 0 24px; font-size: 14px; }
		#message a { display: block; text-align: center; background: #039be5; text-transform: uppercase; text-decoration: none; color: white; padding: 16px; border-radius: 4px; }
		#message, #message a { box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); }
		#load { color: rgba(0,0,0,0.4); text-align: center; font-size: 13px; }
		@media (max-width: 600px) {
			body, #message { margin-top: 0; background: white; box-shadow: none; }
			body { border-top: 16px solid #ffa100; }
		}
	</style>
</head>
<body>
	<!-- The core Firebase JS SDK is always required and must be listed first -->
	<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
	https://firebase.google.com/docs/web/setup#available-libraries -->
	<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-analytics.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>

	<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
  	apiKey: "AIzaSyBK1871-RHYpBd68Teaiw_wD1z9LL-TSsc",
  	authDomain: "chaircheckup.firebaseapp.com",
  	databaseURL: "https://chaircheckup-default-rtdb.europe-west1.firebasedatabase.app",
  	projectId: "chaircheckup",
  	storageBucket: "chaircheckup.appspot.com",
  	messagingSenderId: "1093105648918",
  	appId: "1:1093105648918:web:49b5a3cb4a476aff0ebc37",
  	measurementId: "G-1F1CN628CT"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();

  var database = firebase.database();

  var array10 = [];
  var array25 = [];
  var array50 = [];
  var array100 = [];
  var array400 = []; 
</script>

<h1 align="center">Seating Time</h1>


<div align="center" id="chart"></div>

<script type="text/javascript" 
src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">
	google.charts.load('current', {'packages':['corechart']});
	google.charts.setOnLoadCallback(drawChart);
	
	function drawChart() {

		var timeDataRef = database.ref("Data/OccupationTime").orderByKey();
		timeDataRef.once("value")
		.then(function(snapshot) {
			snapshot.forEach(function(childSnapshot) {
				var key = childSnapshot.key;
				var childData = Number(childSnapshot.val());
				if(childData <= 10){
					array10.push(childData);
				}else if(childData <= 25){
					array25.push(childData);
				}else if(childData <= 50){
					array50.push(childData);
				}else if(childData <= 100){
					array100.push(childData);
				}else if(childData > 100){
					array400.push(childData);
				}
			});
		});

		var data = google.visualization.arrayToDataTable([
			['Time seated in minutes', 'Ammount of times measured'],
			['less than 10 minutes', array10.length],
			['less than 25 minutes', array25.length],
			['less than 50 minutes', array50.length],
			['less than 100 minutes', array100.length],
			['greater than 100 minutes', array400.length]
			]);
		
		var options = {'title':'My Average Seating time',  'width':600,'height':400,is3D: true};
		
		var chart = new google.visualization.ColumnChart(document.getElementById('chart'));
		chart.draw(data, options);

		array10 = [];
		array25 = [];
		array50 = [];
		array100 = [];
		array400 = [];
	}

</script>
<div align="center">
	<button type="button"  onclick="drawChart()">Refresh</button>
</div>
</body>
</html>
